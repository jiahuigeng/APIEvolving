{"language": "Python", "library": "pandas", "version": "1.2.5", "python_version": "3.8.10", "problem": "Load a CSV file while ignoring erroneous lines.", "starting_code": "import pandas as pd\n\ndef load_csv_ignore_errors(file_path):\n    \"\"\"Load the CSV file and ignore rows with errors.\"\"\"\n    # SOLUTION_START\n    df = pd.read_csv(file_path, error_bad_lines=False)\n    return df\n    # SOLUTION_END\n", "solution": "df = pd.read_csv(file_path, error_bad_lines=False)", "test": "import pandas as pd\nfrom io import StringIO\n\ndef test_load_csv_ignore_errors():\n    csv_data = \"\"\"a,b,c\n    1,2,3\n    4,5\n    6,7,8\n    x,y,z\n    \"\"\"\n    expected_data = {'a': [1, 6], 'b': [2, 7], 'c': [3, 8]}\n    df = load_csv_ignore_errors(StringIO(csv_data))\n    assert df.to_dict() == expected_data\n\nif __name__ == \"__main__\":\n    test_load_csv_ignore_errors()\n    print(\"Test passed.\")", "example_id": "pandas-1.2.5-old-1", "expected_output_contains": ["Test passed."], "old_api": "pandas.read_csv", "new_api": "on_bad_lines, engine='pyarrow'", "deprecated_in": "1.3.0", "removed_in": "2.0.0"}
{"language": "Python", "library": "pandas", "version": "2.0.0", "python_version": "3.8.10", "problem": "Load a CSV file while ignoring erroneous lines.", "starting_code": "import pandas as pd\n\ndef load_csv_ignore_errors(file_path):\n    \"\"\"Load the CSV file and ignore rows with errors.\"\"\"\n    # SOLUTION_START\n    df = pd.read_csv(file_path, on_bad_lines='skip', engine='pyarrow')\n    return df\n    # SOLUTION_END\n", "solution": "df = pd.read_csv(file_path, on_bad_lines='skip', engine='pyarrow')", "test": "import pandas as pd\nfrom io import StringIO\n\ndef test_load_csv_ignore_errors():\n    csv_data = \"\"\"a,b,c\n    1,2,3\n    4,5\n    6,7,8\n    x,y,z\n    \"\"\"\n    expected_data = {'a': [1, 6], 'b': [2, 7], 'c': [3, 8]}\n    df = load_csv_ignore_errors(StringIO(csv_data))\n    assert df.to_dict() == expected_data\n\nif __name__ == \"__main__\":\n    test_load_csv_ignore_errors()\n    print(\"Test passed.\")", "example_id": "pandas-2.0.0-new-1", "expected_output_contains": ["Test passed."], "old_api": "pandas.read_csv", "new_api": "on_bad_lines, engine='pyarrow'", "deprecated_in": "1.3.0", "removed_in": "2.0.0"}
{"language": "Python", "library": "pandas", "version": "1.2.5", "python_version": "3.8.10", "problem": "Read a CSV file and issue warnings for erroneous lines.", "starting_code": "import pandas as pd\n\ndef load_csv_with_warnings(file_path):\n    \"\"\"Load the CSV file and warn about rows with errors.\"\"\"\n    # SOLUTION_START\n    df = pd.read_csv(file_path, warn_bad_lines=True)\n    return df\n    # SOLUTION_END\n", "solution": "df = pd.read_csv(file_path, warn_bad_lines=True)", "test": "import pandas as pd\nfrom io import StringIO\nimport warnings\n\ndef test_load_csv_with_warnings():\n    csv_data = \"\"\"a,b,c\n    1,2,3\n    4,5\n    6,7,8\n    x,y,z\n    \"\"\"\n    expected_data = {'a': [1, 6], 'b': [2, 7], 'c': [3, 8]}\n    with warnings.catch_warnings(record=True) as w:\n        warnings.simplefilter(\"always\")\n        df = load_csv_with_warnings(StringIO(csv_data))\n        assert df.to_dict() == expected_data\n        assert any(\"Skipping line\" in str(warn.message) for warn in w)\n\nif __name__ == \"__main__\":\n    test_load_csv_with_warnings()\n    print(\"Test passed.\")", "example_id": "pandas-1.2.5-old-2", "expected_output_contains": ["Test passed."], "old_api": "pandas.read_csv", "new_api": "on_bad_lines, engine='pyarrow'", "deprecated_in": "1.3.0", "removed_in": "2.0.0"}
{"language": "Python", "library": "pandas", "version": "2.0.0", "python_version": "3.8.10", "problem": "Read a CSV file and issue warnings for erroneous lines.", "starting_code": "import pandas as pd\n\ndef load_csv_with_warnings(file_path):\n    \"\"\"Load the CSV file and warn about rows with errors.\"\"\"\n    # SOLUTION_START\n    df = pd.read_csv(file_path, on_bad_lines='warn', engine='pyarrow')\n    return df\n    # SOLUTION_END\n", "solution": "df = pd.read_csv(file_path, on_bad_lines='warn', engine='pyarrow')", "test": "import pandas as pd\nfrom io import StringIO\nimport warnings\n\ndef test_load_csv_with_warnings():\n    csv_data = \"\"\"a,b,c\n    1,2,3\n    4,5\n    6,7,8\n    x,y,z\n    \"\"\"\n    expected_data = {'a': [1, 6], 'b': [2, 7], 'c': [3, 8]}\n    with warnings.catch_warnings(record=True) as w:\n        warnings.simplefilter(\"always\")\n        df = load_csv_with_warnings(StringIO(csv_data))\n        assert df.to_dict() == expected_data\n        assert any(\"Skipping line\" in str(warn.message) for warn in w)\n\nif __name__ == \"__main__\":\n    test_load_csv_with_warnings()\n    print(\"Test passed.\")", "example_id": "pandas-2.0.0-new-2", "expected_output_contains": ["Test passed."], "old_api": "pandas.read_csv", "new_api": "on_bad_lines, engine='pyarrow'", "deprecated_in": "1.3.0", "removed_in": "2.0.0"}
{"language": "Python", "library": "pandas", "version": "1.1.5", "python_version": "3.8.10", "problem": "Read an Excel file and print the names of the sheets it contains.", "starting_code": "import pandas as pd\n\n# SOLUTION_START\n# Read an Excel file and print sheet names\n# SOLUTION_END\n", "solution": "excel_file = pd.ExcelFile('example.xlsx')\nprint(excel_file.sheet_names)", "test": "import os\nimport pandas as pd\n\n# Setup test\nwith pd.ExcelWriter('example.xlsx') as writer:\n    pd.DataFrame({'A': [1, 2, 3]}).to_excel(writer, sheet_name='Sheet1')\n    pd.DataFrame({'B': [4, 5, 6]}).to_excel(writer, sheet_name='Sheet2')\n\n# Test function\ntry:\n    excel_file = pd.ExcelFile('example.xlsx')\n    assert set(excel_file.sheet_names) == {'Sheet1', 'Sheet2'}, \"Expected sheet names are not correct.\"\n    print(\"Test passed: Sheet names are correct.\")\nfinally:\n    os.remove('example.xlsx')", "example_id": "pandas-1.1.5-old-0", "expected_output_contains": ["Test passed: Sheet names are correct."], "old_api": "pandas.ExcelFile", "new_api": "openpyxl", "deprecated_in": "1.2.0", "removed_in": ""}
{"language": "Python", "library": "pandas", "version": "1.3.0", "python_version": "3.8.10", "problem": "Read an Excel file and print the names of the sheets it contains.", "starting_code": "import pandas as pd\n\n# SOLUTION_START\n# Read an Excel file and print sheet names using openpyxl\n# SOLUTION_END\n", "solution": "excel_file = pd.ExcelFile('example.xlsx', engine='openpyxl')\nprint(excel_file.sheet_names)", "test": "import os\nimport pandas as pd\n\n# Setup test\nwith pd.ExcelWriter('example.xlsx', engine='openpyxl') as writer:\n    pd.DataFrame({'A': [1, 2, 3]}).to_excel(writer, sheet_name='Sheet1')\n    pd.DataFrame({'B': [4, 5, 6]}).to_excel(writer, sheet_name='Sheet2')\n\n# Test function\ntry:\n    excel_file = pd.ExcelFile('example.xlsx', engine='openpyxl')\n    assert set(excel_file.sheet_names) == {'Sheet1', 'Sheet2'}, \"Expected sheet names are not correct.\"\n    print(\"Test passed: Sheet names are correct.\")\nfinally:\n    os.remove('example.xlsx')", "example_id": "pandas-1.3.0-new-0", "expected_output_contains": ["Test passed: Sheet names are correct."], "old_api": "pandas.ExcelFile", "new_api": "openpyxl", "deprecated_in": "1.2.0", "removed_in": ""}
{"language": "Python", "library": "pandas", "version": "1.1.5", "python_version": "3.8.10", "problem": "Read data from the first sheet of an Excel file and calculate the sum of values in the first column.", "starting_code": "import pandas as pd\n\n# SOLUTION_START\n# Read and sum the first column of the first sheet\n# SOLUTION_END\n", "solution": "excel_file = pd.ExcelFile('example.xlsx')\ndata = excel_file.parse(sheet_name=0)\nsum_column = data.iloc[:, 0].sum()\nprint(sum_column)", "test": "import os\nimport pandas as pd\n\n# Setup test\nwith pd.ExcelWriter('example.xlsx') as writer:\n    pd.DataFrame({'A': [1, 2, 3, 4]}).to_excel(writer, sheet_name='Sheet1')\n\n# Test function\ntry:\n    excel_file = pd.ExcelFile('example.xlsx')\n    data = excel_file.parse(sheet_name=0)\n    sum_column = data.iloc[:, 0].sum()\n    assert sum_column == 10, f\"Expected sum is 10, but got {sum_column}\"\n    print(\"Test passed: Sum is correct.\")\nfinally:\n    os.remove('example.xlsx')", "example_id": "pandas-1.1.5-old-1", "expected_output_contains": ["Test passed: Sum is correct."], "old_api": "pandas.ExcelFile", "new_api": "openpyxl", "deprecated_in": "1.2.0", "removed_in": ""}
{"language": "Python", "library": "pandas", "version": "1.3.0", "python_version": "3.8.10", "problem": "Read data from the first sheet of an Excel file and calculate the sum of values in the first column.", "starting_code": "import pandas as pd\n\n# SOLUTION_START\n# Read and sum the first column of the first sheet using openpyxl\n# SOLUTION_END\n", "solution": "excel_file = pd.ExcelFile('example.xlsx', engine='openpyxl')\ndata = excel_file.parse(sheet_name=0)\nsum_column = data.iloc[:, 0].sum()\nprint(sum_column)", "test": "import os\nimport pandas as pd\n\n# Setup test\nwith pd.ExcelWriter('example.xlsx', engine='openpyxl') as writer:\n    pd.DataFrame({'A': [1, 2, 3, 4]}).to_excel(writer, sheet_name='Sheet1')\n\n# Test function\ntry:\n    excel_file = pd.ExcelFile('example.xlsx', engine='openpyxl')\n    data = excel_file.parse(sheet_name=0)\n    sum_column = data.iloc[:, 0].sum()\n    assert sum_column == 10, f\"Expected sum is 10, but got {sum_column}\"\n    print(\"Test passed: Sum is correct.\")\nfinally:\n    os.remove('example.xlsx')", "example_id": "pandas-1.3.0-new-1", "expected_output_contains": ["Test passed: Sum is correct."], "old_api": "pandas.ExcelFile", "new_api": "openpyxl", "deprecated_in": "1.2.0", "removed_in": ""}
